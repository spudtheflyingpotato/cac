;try {
/* module-key = 'com.atlassian.confluence.extra.officeconnector:macro-browser-smart-fields', location = 'javascript/office-connector-macro-fields.js' */
(function(b){var a=function(c){this.fileTypes=c};a.prototype.beforeParamsSet=function(e,c){if(!e.page&&!(e.date||e.space)){if(AJS.params.contentType=="page"||AJS.params.contentType=="blogpost"){e.page=b("#content-title").val()}else{if(AJS.params.contentType=="comment"){e.page=AJS.params.pageTitle}}}if(e.date){var d=e.date.split("/");e.page=["",d[2],d[0],d[1],e.page].join("/")}if(e.space){e.page=e.space+":"+e.page}return e};a.prototype.beforeParamsRetrieved=function(e){if(e.page){var d=e.page.split(":");if(d.length>1){e.space=d[0];e.page=d[1]}var c=e.page.split("/");if(c.length>1){e.date=[c[2],c[3],c[1]].join("/");e.page=c[4]}if(((AJS.params.contentType=="page"||AJS.params.contentType=="blogpost")&&e.page==b("#content-title").val())||(AJS.params.contentType=="comment"&&e.page==AJS.params.pageTitle)){delete e.page}}return e};a.prototype.fields={attachment:function(f){var c=function(g){var i={};var h=g.split(":",2);i.spaceKey=((h.length==2)&&h[0])||AJS.params.spaceKey;i.title=h[h.length-1];if(i.title.indexOf("/")==0){i.postingDay=i.title.substr(1,10);i.title=i.title.substr(12)}if(i.title==b("#content-title").val()){i.title=""}if(!i.title){if(AJS.params.newPage){i.draftId=AJS.params.contentId}else{i.pageId=AJS.params.pageId}}return i};var d={fileTypes:this.fileTypes};var e=AJS.MacroBrowser.ParameterFields.attachment(f,d);e.dependencyUpdated=function(i,h){AJS.log("attachment:dependencyUpdated called: "+i+", "+h);var g=c(h);this.getData(g)};return e},spacekey:function(c){return AJS.MacroBrowser.ParameterFields._hidden(c,{})},date:function(c){return AJS.MacroBrowser.ParameterFields._hidden(c,{})},"confluence-content":function(d){var c={dependencies:["name"]};return AJS.MacroBrowser.ParameterFields["confluence-content"](d,c)}};AJS.MacroBrowser.Macros.viewdoc=new a(["doc","docx"]);AJS.MacroBrowser.Macros.viewpdf=new a(["pdf"]);AJS.MacroBrowser.Macros.viewxls=new a(["xls","xlsx"]);AJS.MacroBrowser.Macros.viewppt=new a(["ppt","pptx"]);AJS.MacroBrowser.Macros.viewfile={updateSelectedMacro:function(d){var f=d.params[""]||d.params.name;if(f){var e=f.lastIndexOf(".");if(e>0){var c=f.substring(e+1);if(c){(c=="doc")&&(c=="docx")&&(d.name="viewdoc");(c=="pdf")&&(d.name="viewpdf");(c=="ppt")&&(c=="pptx")&&(d.name="viewppt");(c=="xls")&&(c=="xlsx")&&(d.name="viewxls")}}}}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
